(function(){this.StepsController=function(){this.friendsUrl="/baby-steps.json"};StepsController.prototype.start=function(){fetchFriendsData.call(this);setupListeners.call(this);renderFirstStep.call(this)};StepsController.prototype.fetchFriends=function(){fetchFriendsData.call(this)};renderFirstStep=function(){firstStep=window.steps.eq(0);$("#baby-step-1-btn").parent().addClass("selected");$(".baby-steps-container").html(firstStep)};setupListeners=function(){$("#baby-step-nav a").click($.proxy(selectStep,this))};selectStep=function(b){b.preventDefault();if($(b.target).parent().hasClass("selected")){return}var a=$(b.target).attr("href");$("#baby-step-nav .selected").removeClass("selected");$(b.target).parent().addClass("selected");animateToStep.call(this,a)};animateToStep=function(a){if(this.tween){this.tween.kill()}this.currentStepView=$(".baby-steps .baby-step").not(a);this.newStepView=window.steps.filter(a);this.stagingPos="120%";this.exitPos="-120%";if(window.steps.index(this.newStepView)<window.steps.index(this.currentStepView)){this.stagingPos="-120%";this.exitPos="120%"}this.tween=t=new TimelineLite();t.add($.proxy(stageAnimation,this));t.add(slide(this.newStepView,0,0.45));t.add(slide(this.currentStepView,this.exitPos,0.45),"-= 0.45");t.add($.proxy(cleanUpOldView,this));t.play()};slide=function(a,c,b){return TweenLite.to(a,b,{css:{left:c},ease:Power2.easeInOut})};stageAnimation=function(){$(this.currentStepView).add(this.newStepView).css({position:"absolute",top:"0",left:"0",width:"100%"});$(this.newStepView).css({left:this.stagingPos});$(".baby-steps-container").append(this.newStepView)};cleanUpOldView=function(){this.currentStepView.remove()};fetchFriendsData=function(){$.ajax({url:this.friendsUrl}).done($.proxy(loadFriendsData,this))};loadFriendsData=function(d){var b=_.groupBy(d.friends,"babyStep");for(var c in b){var a=_.sortBy(b[c],function(e){return[e.lastName,e.firstName].join("")});addFriendsView(c,a)}};addFriendsView=function(a,d){var f=$('<footer class="friends"></footer>');var i=[];var b=d.length>1?"are":"is";var c=d.length>2?", ":" and ";var h=b+" also in Baby Step "+a;var e=0;while(e<2&&e<d.length){i.push(['<a href="#">',[d[e].firstName,d[e].lastName].join(" "),"</a>"].join(""));e++}if(d.length>2){var g=d.length-2;var j=g>1?"s":"";i.push("and "+g+" other friend"+j)}f.append([i.join(c),h].join(" "));stepView=window.steps.filter("#baby-step-"+a);stepView.find(".friends").remove();stepView.append(f)}}());$(function(){var a=window.app=new StepsController();a.start()});